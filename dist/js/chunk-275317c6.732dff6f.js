(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-275317c6"],{"46a1":function(t,e,a){},"7d81":function(t,e,a){"use strict";var n=a("46a1"),i=a.n(n);i.a},becf:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("van-cell-group",[a("van-field",{attrs:{label:"商户名称","input-align":"right",placeholder:"请输入"},model:{value:t.data.name,callback:function(e){t.$set(t.data,"name",e)},expression:"data.name"}}),a("van-field",{attrs:{label:"账号","input-align":"right",placeholder:"请输入邮箱地址"},model:{value:t.data.account,callback:function(e){t.$set(t.data,"account",e)},expression:"data.account"}}),a("van-field",{attrs:{label:"初始密码",type:t.inputType,"input-align":"right","right-icon":t.passwordIconType,placeholder:"请输入"},on:{"click-right-icon":t.righIconBtn},model:{value:t.data.password,callback:function(e){t.$set(t.data,"password",e)},expression:"data.password"}}),a("van-field",{attrs:{label:"手机号",type:"tel","input-align":"right",placeholder:"请输入"},model:{value:t.data.phone,callback:function(e){t.$set(t.data,"phone",e)},expression:"data.phone"}}),a("div",{staticClass:"van-cell van-field"},[a("div",{staticClass:"van-cell__title van-field__label"},[t._v("是否启用")]),a("div",{staticClass:"van-cell__value"},[a("van-switch",{attrs:{size:"22px"},model:{value:t.data.checked,callback:function(e){t.$set(t.data,"checked",e)},expression:"data.checked"}})],1)])],1),a("span",{staticClass:"box1"},[a("span",{staticClass:"title"},[t._v("关联场所")]),a("span",{staticStyle:{background:"white",padding:"0.26rem 0rem"}},[a("span",{staticClass:"add",on:{click:t.btnPlace}},[a("van-icon",{attrs:{name:"plus",size:"0.5rem"}}),a("span",{staticStyle:{"margin-left":"0.06rem"}},[t._v("请选择")])],1)]),a("span",{staticClass:"body"},t._l(t.data.ktvList,function(e){return a("PlaceItem",{key:e.id},[a("van-cell",{attrs:{value:e.name},on:{click:function(a){return t.deletBtn(e)}}},[a("van-icon",{attrs:{slot:"right-icon",name:"clear"},slot:"right-icon"})],1)],1)}),1)]),t.box2Flage?a("div",{staticClass:"box2"},[a("addPlace",{on:{ok:t.btnPlace},model:{value:t.data.ktvList,callback:function(e){t.$set(t.data,"ktvList",e)},expression:"data.ktvList"}})],1):t._e(),a("span",{staticClass:"footer"},["编辑商户"==t.title?a("van-button",{staticClass:"button",attrs:{size:"large"},on:{click:function(e){return t.handleFrom("edite")}}},[t._v("保存")]):a("van-button",{staticClass:"button",attrs:{size:"large"},on:{click:function(e){return t.handleFrom("create")}}},[t._v("创建")])],1)],1)},i=[],s=(a("7364"),a("8492")),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"placeBox"},[t._t("default")],2)},l=[],o=(a("eb00"),a("17cc")),r={},d=Object(o["a"])(r,c,l,!1,null,"01655754",null),u=d.exports,h=a("71fd"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"searchPageBox"},[a("span",{staticClass:"nav"},[a("van-search",{attrs:{placeholder:"请输入门店名称","show-action":"",shape:"round",background:"#f4f4f4"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}},[a("div",{staticClass:"navRight",attrs:{slot:"action"},slot:"action"})])],1),a("span",{staticClass:"body"},[""!=t.searchValue?a("van-list",{attrs:{finished:t.finished,"finished-text":t.finishedText},on:{load:t.getList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,function(e){return a("span",{key:e.id,on:{click:function(a){return t.selectBtn(e)}}},[e.isSelected?a("van-cell",{attrs:{value:e.name}},[a("van-icon",{attrs:{slot:"right-icon",name:"checked",color:"#01cca3"},slot:"right-icon"})],1):a("van-cell",{attrs:{value:e.name}})],1)}),0):t._e()],1),a("span",{staticClass:"footer"},[a("van-button",{staticClass:"button",attrs:{size:"large"},on:{click:t.onClickBtn}},[t._v("返回")])],1)])},f=[],v=a("71a5"),g=a("c276"),m={props:{value:{type:Array,default:function(){return[]}}},model:{prop:"value",event:"retunBack"},data:function(){return{selectArr:this.value,loading:!1,finished:!1,searchValue:"",list:[],page:1,page_size:30,total:"",finishedText:"没有更多了"}},methods:{onClickBtn:function(){this.$emit("ok")},selectBtn:function(t){t.isSelected?(t.isSelected=!1,this.selectArr.splice(this.selectArr.indexOf(t),1)):(t.isSelected=!0,this.selectArr.push(t)),this.$emit("retunBack",this.selectArr)},init:function(){this.list=[],this.total=0,this.page=1,this.page_size=30,this.loading=!1,this.finished=!1,this.finishedText="没有更多了！",this.getList()},getList:function(){var t=this,e={name:this.searchValue,page:this.page,page_size:this.page_size};Object(v["f"])(e).then(function(e){e.data.results.map(function(t){return t.isSelected=!1});var a=t.list.concat(e.data.results),n={};t.list=a.reduce(function(t,e){return!n[e.id]&&(n[e.id]=t.push(e)),t},[]),console.log(t.value),Object(g["r"])(t.value,t.list),console.log(t.list),t.finishedText="没有更多了！",t.page++,t.total=e.data.count,t.loading=!1,0==t.list.length&&(t.finishedText="暂无搜索内容！"),t.list.length>=t.total&&(t.finished=!0)})}},watch:{searchValue:{handler:function(t,e){""!=t&&this.init()},immediate:!0}},mounted:function(){}},b=m,k=(a("d00a"),Object(o["a"])(b,p,f,!1,null,"951d582a",null)),x=k.exports,_={components:{PlaceItem:u,addPlace:x},data:function(){return{inputTypeFlag:!0,box2Flage:!1,data:{name:"",account:"",password:"",phone:"",checked:!0,ktvList:[]}}},computed:{title:function(){return"edite"==this.$route.params.type?(document.title="编辑商户","编辑商户"):(document.title="新建商户","新建商户")},passwordIconType:function(){return this.inputTypeFlag?"closed-eye":"eye-o"},inputType:function(){return this.inputTypeFlag?"password":"text"}},methods:{deletBtn:function(t){this.data.ktvList.splice(this.data.ktvList.indexOf(t),1)},righIconBtn:function(){this.inputTypeFlag=!this.inputTypeFlag},btnPlace:function(){this.box2Flage=!this.box2Flage},handleFrom:function(t){var e=this;this.loading=!0;var a={name:this.data.name,account:this.data.account,password:this.data.password,ktv:this.data.ktvList.reduce(function(t,e){return t.push(e.id+""),t},[]),status:this.data.checked?"1":"0"};console.log(a),"edite"==t?(a.id=this.data.id,Object(s["b"])(a).then(function(t){e.loading=!1,h["c"].success("编辑成功"),setTimeout(function(){e.$router.go(-1)},500)}).catch(function(t){h["c"].fail("编辑失败"),e.loading=!1})):Object(s["a"])(a).then(function(t){e.loading=!1,h["c"].success("创建成功"),setTimeout(function(){e.$router.go(-1)},500)}).catch(function(t){h["c"].fail("创建失败"),e.loading=!1})}},mounted:function(){"edite"==this.$route.params.type&&(this.data=this.$route.params.data)}},y=_,C=(a("7d81"),Object(o["a"])(y,n,i,!1,null,"1039b092",null));e["default"]=C.exports},d00a:function(t,e,a){"use strict";var n=a("e6f8"),i=a.n(n);i.a},d537:function(t,e,a){},e6f8:function(t,e,a){},eb00:function(t,e,a){"use strict";var n=a("d537"),i=a.n(n);i.a}}]);
//# sourceMappingURL=chunk-275317c6.732dff6f.js.map